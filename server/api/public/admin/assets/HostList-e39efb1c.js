/* empty css             *//* empty css                        *//* empty css                *//* empty css                   *//* empty css                 *//* empty css                  */import{d as z,K as I,c as L,a as t,w as e,b as P,q as Y,E as N,o as m,e as f,g as l,M as j,n as R,t as v,r as h,y,i as p,O as S,z as U,l as q,Q as A,j as K,R as O,S as Q,T as F,_ as G}from"./index-f7b4a7a3.js";import{h as k}from"./host-3aae7e3b.js";const J={class:"host-list"},W={class:"card-header"},X=z({__name:"HostList",setup(Z){const r=P(),c=h(!1),u=h([]);async function _(){c.value=!0;try{const o=await k.list();u.value=o.data}finally{c.value=!1}}function b(){r.push("/hosts/create")}function g(o){r.push(`/hosts/${o.id}/edit`)}function C(o){r.push(`/hosts/${o.id}/data`)}async function x(o){try{await y.confirm(`确定要删除主机 "${o.hostname}" 吗？此操作不可恢复！`,"警告",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"});try{const{value:a}=await y.prompt("为了防止误操作，请输入管理员密码确认删除","安全验证",{confirmButtonText:"确认删除",cancelButtonText:"取消",inputType:"password",inputPattern:/.+/,inputErrorMessage:"请输入密码",inputPlaceholder:"请输入管理员密码"});await k.delete(o.id,{password:a}),p.success("删除成功"),_()}catch{p.info("已取消删除")}}catch{}}function T(o){navigator.clipboard.writeText(o),p.success("Token已复制")}function E(o){return S(o).format("YYYY-MM-DD HH:mm:ss")}return I(()=>{_()}),(o,a)=>{const w=Y("Plus"),B=U,i=q,s=A,D=K,V=O,M=Q,$=N,H=F;return m(),L("div",J,[t($,null,{header:e(()=>[f("div",W,[a[1]||(a[1]=f("span",null,"主机列表",-1)),t(i,{type:"primary",onClick:b},{default:e(()=>[t(B,null,{default:e(()=>[t(w)]),_:1}),a[0]||(a[0]=l(" 新增主机 ",-1))]),_:1})])]),default:e(()=>[j((m(),R(M,{data:u.value,stripe:""},{default:e(()=>[t(s,{prop:"id",label:"ID",width:"80"}),t(s,{prop:"hostname",label:"主机名"}),t(s,{label:"Token",width:"300"},{default:e(({row:n})=>[t(D,{modelValue:n.token,"onUpdate:modelValue":d=>n.token=d,type:"text",readonly:"",size:"small"},{append:e(()=>[t(i,{onClick:d=>T(n.token)},{default:e(()=>[...a[2]||(a[2]=[l("复制",-1)])]),_:1},8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),t(s,{prop:"remark",label:"备注"}),t(s,{prop:"report_interval",label:"上报间隔(秒)",width:"120"}),t(s,{label:"状态",width:"80"},{default:e(({row:n})=>[t(V,{type:n.is_active?"success":"info"},{default:e(()=>[l(v(n.is_active?"活跃":"停用"),1)]),_:2},1032,["type"])]),_:1}),t(s,{prop:"updated_at",label:"最后上报",width:"180"},{default:e(({row:n})=>[l(v(n.latest_data?E(n.latest_data.report_time):"-"),1)]),_:1}),t(s,{label:"操作",width:"220",fixed:"right"},{default:e(({row:n})=>[t(i,{size:"small",onClick:d=>C(n)},{default:e(()=>[...a[3]||(a[3]=[l("数据",-1)])]),_:1},8,["onClick"]),t(i,{size:"small",onClick:d=>g(n)},{default:e(()=>[...a[4]||(a[4]=[l("编辑",-1)])]),_:1},8,["onClick"]),t(i,{size:"small",type:"danger",onClick:d=>x(n)},{default:e(()=>[...a[5]||(a[5]=[l("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[H,c.value]])]),_:1})])}}});const dt=G(X,[["__scopeId","data-v-417fc24b"]]);export{dt as default};
