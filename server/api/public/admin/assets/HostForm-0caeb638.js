/* empty css             *//* empty css                *//* empty css                     *//* empty css                  *//* empty css                  *//* empty css                 */import{d as F,K as H,c as S,a as t,w as a,b as h,p as R,r as v,x as q,E as j,o as x,e as u,t as w,n as A,g as f,N as D,h as K,i as c,y as W,j as z,k as G,V as J,W as O,l as P,m as Q,_ as X}from"./index-f7b4a7a3.js";import{h as y}from"./host-3aae7e3b.js";const Y={class:"host-form"},Z={class:"card-header"},$=F({__name:"HostForm",setup(ee){const V=h(),g=R(),k=v(),i=v(!1),m=v(""),p=v(),d=q(()=>!!g.params.id),l=K({hostname:"",remark:"",report_interval:300,llm_analysis_interval:3600,alert_rules:"",is_active:!0}),E={hostname:[{required:!0,message:"请输入主机名",trigger:"blur"}],report_interval:[{required:!0,message:"请输入上报间隔",trigger:"blur"}]};async function T(n){i.value=!0;try{const r=await y.get(n);l.hostname=r.hostname,l.remark=r.remark||"",l.report_interval=r.report_interval,l.llm_analysis_interval=r.llm_analysis_interval||3600,l.alert_rules=r.alert_rules||"",l.is_active=r.is_active,m.value=r.token}finally{i.value=!1}}async function C(){k.value&&await k.value.validate(async n=>{if(n){i.value=!0;try{d.value?(await y.update(p.value,l),c.success("保存成功")):(await y.create(l),c.success("创建成功")),V.push("/hosts")}finally{i.value=!1}}})}function N(){V.push("/hosts")}function U(){navigator.clipboard.writeText(m.value),c.success("Token已复制")}async function B(){try{await W.confirm("重新生成Token后，旧Token将失效，是否继续？","警告",{type:"warning"});const n=await y.regenerateToken(p.value);m.value=n.token,c.success("Token已重新生成")}catch{}}return H(()=>{d.value&&(p.value=Number(g.params.id),T(p.value))}),(n,e)=>{const r=z,s=G,b=J,I=O,_=P,L=Q,M=j;return x(),S("div",Y,[t(M,null,{header:a(()=>[u("div",Z,[u("span",null,w(d.value?"编辑主机":"新增主机"),1)])]),default:a(()=>[t(L,{model:l,rules:E,ref_key:"formRef",ref:k,"label-width":"120px"},{default:a(()=>[t(s,{label:"主机名",prop:"hostname"},{default:a(()=>[t(r,{modelValue:l.hostname,"onUpdate:modelValue":e[0]||(e[0]=o=>l.hostname=o),placeholder:"例如: server-01"},null,8,["modelValue"])]),_:1}),t(s,{label:"备注",prop:"remark"},{default:a(()=>[t(r,{modelValue:l.remark,"onUpdate:modelValue":e[1]||(e[1]=o=>l.remark=o),type:"textarea",rows:3,placeholder:"主机备注信息"},null,8,["modelValue"])]),_:1}),t(s,{label:"上报间隔",prop:"report_interval"},{default:a(()=>[t(b,{modelValue:l.report_interval,"onUpdate:modelValue":e[2]||(e[2]=o=>l.report_interval=o),min:10,max:3600,step:10},null,8,["modelValue"]),e[7]||(e[7]=u("span",{style:{"margin-left":"10px",color:"#909399"}},"秒 (10-3600)",-1))]),_:1}),t(s,{label:"LLM分析间隔",prop:"llm_analysis_interval"},{default:a(()=>[t(b,{modelValue:l.llm_analysis_interval,"onUpdate:modelValue":e[3]||(e[3]=o=>l.llm_analysis_interval=o),min:300,max:86400,step:300},null,8,["modelValue"]),e[8]||(e[8]=u("span",{style:{"margin-left":"10px",color:"#909399"}},"秒 (300-86400, 默认3600=1小时)",-1)),e[9]||(e[9]=u("div",{class:"form-tip"}," LLM分析时间间隔，不会影响数据上报频率 ",-1))]),_:1}),t(s,{label:"预警规则",prop:"alert_rules"},{default:a(()=>[t(r,{modelValue:l.alert_rules,"onUpdate:modelValue":e[4]||(e[4]=o=>l.alert_rules=o),type:"textarea",rows:5,placeholder:`使用自然语言描述预警规则，例如：
1. SSH登录失败超过5次
2. 系统负载超过5.0
3. 网络流量异常增长`},null,8,["modelValue"]),e[10]||(e[10]=u("div",{class:"form-tip"}," 提示：LLM将根据这些规则分析服务器数据并判断是否触发预警 ",-1))]),_:1}),t(s,{label:"状态",prop:"is_active"},{default:a(()=>[t(I,{modelValue:l.is_active,"onUpdate:modelValue":e[5]||(e[5]=o=>l.is_active=o),"active-text":"活跃","inactive-text":"停用"},null,8,["modelValue"])]),_:1}),d.value?(x(),A(s,{key:0,label:"Token"},{default:a(()=>[t(r,{modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=o=>m.value=o),readonly:""},{append:a(()=>[t(_,{onClick:U},{default:a(()=>[...e[11]||(e[11]=[f("复制",-1)])]),_:1}),t(_,{onClick:B},{default:a(()=>[...e[12]||(e[12]=[f("重新生成",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})):D("",!0),t(s,null,{default:a(()=>[t(_,{type:"primary",onClick:C,loading:i.value},{default:a(()=>[f(w(d.value?"保存":"创建"),1)]),_:1},8,["loading"]),t(_,{onClick:N},{default:a(()=>[...e[13]||(e[13]=[f("取消",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}});const ie=X($,[["__scopeId","data-v-bec0d716"]]);export{ie as default};
