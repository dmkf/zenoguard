/* empty css             *//* empty css                *//* empty css                   *//* empty css                     *//* empty css                  *//* empty css                  *//* empty css                 */import{ae as p,d as W,K as B,c as I,a as t,w as o,E as N,o as U,e as a,g as k,r as m,h as F,i as c,j as M,k as R,W as S,l as T,m as j,af as q,ag as D,_ as K}from"./index-f7b4a7a3.js";const g={list(){return p.get("/alert")},update(s){return p.put("/alert",s)},test(s="dingtalk"){return p.post("/alert/test",{platform:s})},delete(s){return p.delete(`/alert/${s}`)}},$={class:"alert-config"},z=W({__name:"AlertConfig",setup(s){const f=m(),u=m(!1),_=m(!1),l=F({platform:"dingtalk",webhook_url:"",secret:"",is_active:!0}),w={webhook_url:[{required:!0,message:"请输入Webhook地址",trigger:"blur"}]};async function b(){u.value=!0;try{const r=(await g.list()).data.find(i=>i.platform==="dingtalk");r&&(l.webhook_url=r.webhook_url,l.is_active=r.is_active)}finally{u.value=!1}}async function y(){f.value&&await f.value.validate(async n=>{if(n){u.value=!0;try{await g.update(l),c.success("保存成功")}finally{u.value=!1}}})}async function V(){_.value=!0;try{const n=await g.test("dingtalk");n.success?c.success("测试消息已发送"):c.error("发送失败: "+n.message)}finally{_.value=!1}}return B(()=>{b()}),(n,e)=>{const r=M,i=R,x=S,v=T,E=j,C=q,h=D,A=N;return U(),I("div",$,[t(A,null,{header:o(()=>[...e[3]||(e[3]=[a("span",null,"钉钉预警配置",-1)])]),default:o(()=>[t(E,{model:l,rules:w,ref_key:"formRef",ref:f,"label-width":"140px"},{default:o(()=>[t(i,{label:"Webhook地址",prop:"webhook_url"},{default:o(()=>[t(r,{modelValue:l.webhook_url,"onUpdate:modelValue":e[0]||(e[0]=d=>l.webhook_url=d),placeholder:"钉钉机器人Webhook地址"},null,8,["modelValue"]),e[4]||(e[4]=a("div",{class:"form-tip"}," 在钉钉群设置中添加自定义机器人获取Webhook地址 ",-1))]),_:1}),t(i,{label:"签名密钥",prop:"secret"},{default:o(()=>[t(r,{modelValue:l.secret,"onUpdate:modelValue":e[1]||(e[1]=d=>l.secret=d),type:"password","show-password":"",placeholder:"可选：钉钉机器人签名密钥"},null,8,["modelValue"]),e[5]||(e[5]=a("div",{class:"form-tip"}," 如果启用了签名验证，请填写密钥 ",-1))]),_:1}),t(i,{label:"状态",prop:"is_active"},{default:o(()=>[t(x,{modelValue:l.is_active,"onUpdate:modelValue":e[2]||(e[2]=d=>l.is_active=d),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),t(i,null,{default:o(()=>[t(v,{type:"primary",onClick:y,loading:u.value},{default:o(()=>[...e[6]||(e[6]=[k(" 保存 ",-1)])]),_:1},8,["loading"]),t(v,{onClick:V,loading:_.value},{default:o(()=>[...e[7]||(e[7]=[k(" 发送测试 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),t(C),t(h,{title:"配置说明",type:"info",closable:!1},{default:o(()=>[...e[8]||(e[8]=[a("ul",{style:{margin:"10px 0 0 20px",padding:"0"}},[a("li",null,'在钉钉群设置中添加"自定义"机器人'),a("li",null,'安全设置可选择"自定义关键词"或"加签"'),a("li",null,'如果使用"加签"，必须填写签名密钥'),a("li",null,"关键词建议使用：智巡 或 预警")],-1)])]),_:1})]),_:1})])}}});const Y=K(z,[["__scopeId","data-v-1a2d6ea5"]]);export{Y as default};
