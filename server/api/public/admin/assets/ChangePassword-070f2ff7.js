/* empty css             *//* empty css                *//* empty css                     *//* empty css                  *//* empty css                 */import{d as V,c as b,a,w as t,b as x,E as C,o as P,e as u,g as w,r as m,h as k,ah as c,i as f,j as B,k as I,l as F,m as N,_ as R}from"./index-f7b4a7a3.js";const U={class:"change-password"},M=V({__name:"ChangePassword",setup(S){const _=x(),l=m(),i=m(!1),s=k({current_password:"",new_password:"",new_password_confirmation:""}),g={current_password:[{required:!0,message:"请输入当前密码",trigger:"blur"}],new_password:[{validator:(d,e,o)=>{var r;e===""?o(new Error("请输入密码")):e.length<6?o(new Error("密码长度不能少于6位")):(s.new_password_confirmation!==""&&((r=l.value)==null||r.validateField("new_password_confirmation")),o())},trigger:"blur"}],new_password_confirmation:[{validator:(d,e,o)=>{e===""?o(new Error("请再次输入密码")):e!==s.new_password?o(new Error("两次输入密码不一致")):o()},trigger:"blur"}]},v=async()=>{l.value&&await l.value.validate(async d=>{var e,o;if(d){i.value=!0;try{await c.changePassword(s),f.success("密码修改成功，请重新登录"),setTimeout(async()=>{try{await c.logout()}catch{}localStorage.removeItem("token"),_.push("/login")},1500)}catch(r){const p=((o=(e=r.response)==null?void 0:e.data)==null?void 0:o.error)||"密码修改失败";f.error(p)}finally{i.value=!1}}})},h=()=>{_.back()};return(d,e)=>{const o=B,r=I,p=F,y=N,E=C;return P(),b("div",U,[a(E,null,{header:t(()=>[...e[3]||(e[3]=[u("div",{class:"card-header"},[u("span",null,"修改密码")],-1)])]),default:t(()=>[a(y,{ref_key:"formRef",ref:l,model:s,rules:g,"label-width":"120px",style:{"max-width":"500px"}},{default:t(()=>[a(r,{label:"当前密码",prop:"current_password"},{default:t(()=>[a(o,{modelValue:s.current_password,"onUpdate:modelValue":e[0]||(e[0]=n=>s.current_password=n),type:"password",placeholder:"请输入当前密码","show-password":""},null,8,["modelValue"])]),_:1}),a(r,{label:"新密码",prop:"new_password"},{default:t(()=>[a(o,{modelValue:s.new_password,"onUpdate:modelValue":e[1]||(e[1]=n=>s.new_password=n),type:"password",placeholder:"请输入新密码（至少6位）","show-password":""},null,8,["modelValue"])]),_:1}),a(r,{label:"确认密码",prop:"new_password_confirmation"},{default:t(()=>[a(o,{modelValue:s.new_password_confirmation,"onUpdate:modelValue":e[2]||(e[2]=n=>s.new_password_confirmation=n),type:"password",placeholder:"请再次输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),a(r,null,{default:t(()=>[a(p,{type:"primary",onClick:v,loading:i.value},{default:t(()=>[...e[4]||(e[4]=[w(" 修改密码 ",-1)])]),_:1},8,["loading"]),a(p,{onClick:h},{default:t(()=>[...e[5]||(e[5]=[w("取消",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}});const J=R(M,[["__scopeId","data-v-a71bc230"]]);export{J as default};
