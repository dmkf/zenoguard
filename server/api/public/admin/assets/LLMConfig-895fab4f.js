/* empty css             *//* empty css                *//* empty css                   *//* empty css                     *//* empty css                  *//* empty css                  *//* empty css                 */import{ae as y,d as U,K as B,c as S,a as l,w as a,E as T,o as N,e as s,g as i,r as c,h as O,i as m,y as R,j as q,k as D,W as F,af as J,l as j,m as K,ag as W,_ as z}from"./index-f7b4a7a3.js";const g={get(){return y.get("/llm")},update(L){return y.put("/llm",L)},test(){return y.post("/llm/test")}},G={class:"llm-config"},v='你是一个服务器安全分析专家。请根据服务器数据判断是否存在安全问题，并给出简明扼要的分析结果。只返回JSON格式：{"summary": "一句话总结", "is_alert": true/false}',V=`当前服务器数据：
{DATA}

预警规则：{RULES}

请分析：
1. 用一句话总结服务器状态（不超过50字）
2. 判断是否触发预警（true/false）

只返回JSON格式：{"summary": "一句话总结", "is_alert": true/false}`,H=U({__name:"LLMConfig",setup(L){const d=c(),p=c(!1),_=c(!1),t=O({model_name:"",api_url:"",api_key:"",is_active:!0,system_prompt:v,user_prompt:V}),x={model_name:[{required:!0,message:"请输入模型名称",trigger:"blur"}],api_url:[{required:!0,message:"请输入API地址",trigger:"blur"}],api_key:[{required:!0,message:"请输入API密钥",trigger:"blur"}]};async function A(){p.value=!0;try{const r=await g.get();if(r.data){const e=r.data;t.model_name=e.model_name||"",t.api_url=e.api_url||"",t.is_active=e.is_active??!0,t.system_prompt=e.system_prompt||v,t.user_prompt=e.user_prompt||V}}finally{p.value=!1}}async function E(){d.value&&await d.value.validate(async r=>{if(r){p.value=!0;try{await g.update(t),m.success("保存成功")}finally{p.value=!1}}})}async function b(){_.value=!0;try{const r=await g.test();r.success?m.success("连接测试成功"):m.error("连接测试失败: "+r.message)}finally{_.value=!1}}async function I(){try{await R.confirm("确定要重置为默认提示词吗？当前的自定义提示词将丢失。","确认重置",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),t.system_prompt=v,t.user_prompt=V,m.success("已重置为默认提示词，请点击保存按钮保存更改")}catch{}}return B(()=>{A()}),(r,e)=>{const u=q,n=D,k=F,w=J,f=j,M=K,C=W,P=T;return N(),S("div",G,[l(P,null,{header:a(()=>[...e[6]||(e[6]=[s("span",null,"LLM配置",-1)])]),default:a(()=>[l(M,{model:t,rules:x,ref_key:"formRef",ref:d,"label-width":"120px"},{default:a(()=>[l(n,{label:"模型名称",prop:"model_name"},{default:a(()=>[l(u,{modelValue:t.model_name,"onUpdate:modelValue":e[0]||(e[0]=o=>t.model_name=o),placeholder:"例如: gpt-4, gpt-3.5-turbo"},null,8,["modelValue"]),e[7]||(e[7]=s("div",{class:"form-tip"}," OpenAI兼容的模型名称 ",-1))]),_:1}),l(n,{label:"API地址",prop:"api_url"},{default:a(()=>[l(u,{modelValue:t.api_url,"onUpdate:modelValue":e[1]||(e[1]=o=>t.api_url=o),placeholder:"例如: https://api.openai.com/v1/chat/completions"},null,8,["modelValue"]),e[8]||(e[8]=s("div",{class:"form-tip"}," OpenAI兼容的API地址 ",-1))]),_:1}),l(n,{label:"API密钥",prop:"api_key"},{default:a(()=>[l(u,{modelValue:t.api_key,"onUpdate:modelValue":e[2]||(e[2]=o=>t.api_key=o),type:"password","show-password":"",placeholder:"请输入API密钥"},null,8,["modelValue"])]),_:1}),l(n,{label:"状态",prop:"is_active"},{default:a(()=>[l(k,{modelValue:t.is_active,"onUpdate:modelValue":e[3]||(e[3]=o=>t.is_active=o),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),l(w,{"content-position":"left"},{default:a(()=>[...e[9]||(e[9]=[i("提示词配置",-1)])]),_:1}),l(n,{label:"系统提示词",prop:"system_prompt"},{default:a(()=>[l(u,{modelValue:t.system_prompt,"onUpdate:modelValue":e[4]||(e[4]=o=>t.system_prompt=o),type:"textarea",rows:4,placeholder:"定义LLM的角色和行为方式"},null,8,["modelValue"]),e[10]||(e[10]=s("div",{class:"form-tip"}," 定义LLM在分析时的角色定位和行为准则，可使用占位符：{DATA}表示服务器数据，{RULES}表示预警规则 ",-1))]),_:1}),l(n,{label:"用户提示词",prop:"user_prompt"},{default:a(()=>[l(u,{modelValue:t.user_prompt,"onUpdate:modelValue":e[5]||(e[5]=o=>t.user_prompt=o),type:"textarea",rows:6,placeholder:"具体分析任务的描述"},null,8,["modelValue"]),e[11]||(e[11]=s("div",{class:"form-tip"}," 指导LLM如何分析数据的具体指令，应包含分析要求和输出格式说明 ",-1))]),_:1}),l(n,null,{default:a(()=>[l(f,{type:"primary",onClick:E,loading:p.value},{default:a(()=>[...e[12]||(e[12]=[i(" 保存 ",-1)])]),_:1},8,["loading"]),l(f,{onClick:b,loading:_.value},{default:a(()=>[...e[13]||(e[13]=[i(" 测试连接 ",-1)])]),_:1},8,["loading"]),l(f,{onClick:I},{default:a(()=>[...e[14]||(e[14]=[i(" 重置为默认提示词 ",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),l(w),l(C,{title:"使用说明",type:"info",closable:!1},{default:a(()=>[...e[15]||(e[15]=[s("ul",{style:{margin:"10px 0 0 20px",padding:"0"}},[s("li",null,"支持OpenAI兼容的API服务"),s("li",null,"LLM将根据预警规则分析服务器数据"),s("li",null,"分析结果会记录在上报数据中"),s("li",null,"如果分析结果is_alert为true，将触发预警推送"),s("li",null,"可自定义提示词来调整分析行为和输出格式")],-1)])]),_:1})]),_:1})])}}});const le=z(H,[["__scopeId","data-v-41afd33d"]]);export{le as default};
